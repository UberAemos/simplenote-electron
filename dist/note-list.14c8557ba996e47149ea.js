(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{894:function(e,t,n){"use strict";n.r(t),n.d(t,"NoteList",(function(){return z}));var r=n(0),o=n.n(r),a=n(873),i=n(8),c=n.n(i),s=n(110);function l(){return o.a.createElement("svg",{className:"icon-feed",xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M2,8.667V12c5.515,0,10,4.485,10,10h3.333C15.333,14.637,9.363,8.667,2,8.667z M2,2v3.333 c9.19,0,16.667,7.477,16.667,16.667H22C22,10.955,13.045,2,2,2z M4.5,17C3.118,17,2,18.12,2,19.5S3.118,22,4.5,22S7,20.88,7,19.5 S5.882,17,4.5,17z"}))}var u=n(4),p=n(668),f=n.n(p),h=n(182),d=function(e,t){return e.length>0?e.reduce((function(e,t){var n=t.filter,r=t.replacer,o="string"==typeof n&&Object(h.b)(n),a=o&&o.length>0?new RegExp(Object(u.escapeRegExp)(o),"gi"):n;return f()(e,a,r)}),t).map((function(e,t){return e&&"string"!=typeof e?o.a.cloneElement(e,{key:t}):e})):t},y=function(e){return{filter:e,replacer:function(e){if(e.length)return o.a.createElement("span",{className:"search-match"},e)}}},m=n(336),g=n(123),b=n(155);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j(e);if(t){var o=j(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return O(this,n)}}function O(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?S(e):t}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(i,e);var t,n,r,a=E(i);function i(e){var t,n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),t=a.call(this,e),n=S(t),o=void 0,(r="createdAt")in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,t.createdAt=Date.now(),t}return t=i,(n=[{key:"componentDidUpdate",value:function(e){var t,n,r=this;(null===(t=e.note)||void 0===t?void 0:t.content)!==(null===(n=this.props.note)||void 0===n?void 0:n.content)&&this.props.invalidateHeight(),this.props.lastUpdated<1e3&&!this.updateScheduled&&(this.updateScheduled=setTimeout((function(){return r.forceUpdate()}),1e3))}},{key:"render",value:function(){var e=this.props,t=e.displayMode,n=e.hasPendingChanges,r=e.isOpened,a=e.lastUpdated,i=e.noteId,s=e.note,u=e.openNote,p=e.pinNote,f=e.searchQuery,g=e.style;if(!s)return o.a.createElement("div",null,"Couldn't find note");var b=Object(m.a)(s),v=b.title,w=b.preview,N=s.systemTags.includes("pinned"),E=!!s.publishURL,O=a-this.createdAt>1e3&&Date.now()-a<1200,S=c()("note-list-item",{"note-list-item-selected":r,"note-list-item-pinned":N,"note-recently-updated":O,"published-note":E}),j=Object(h.a)(f).map(y);return o.a.createElement("div",{style:g,className:S},o.a.createElement("div",{className:"note-list-item-pinner",tabIndex:0,onClick:function(){return p(i,!N)}}),o.a.createElement("div",{className:"note-list-item-text theme-color-border",tabIndex:0,onClick:function(){return u(i)}},o.a.createElement("div",{className:"note-list-item-title"},o.a.createElement("span",null,n&&"⚠️ ",d(j,v)),E&&o.a.createElement("div",{className:"note-list-item-published-icon"},o.a.createElement(l,null))),"expanded"===t&&w.length>0&&o.a.createElement("div",{className:"note-list-item-excerpt"},w.split("\n").map((function(e,t){return o.a.createElement(o.a.Fragment,{key:t},t>0&&o.a.createElement("br",null),d(j,e.slice(0,200)))}))),"comfy"===t&&w.length>0&&o.a.createElement("div",{className:"note-list-item-excerpt"},d(j,w.slice(0,200)))))}}])&&w(t.prototype,n),r&&w(t,r),i}(r.Component),D={openNote:g.a.ui.openNote,pinNote:g.a.data.pinNote},k=Object(s.b)((function(e,t){var n,r=t.noteId;return{displayMode:e.settings.noteDisplay,hasPendingChanges:b.c(e,r),isOpened:e.ui.openedNote===r,lastUpdated:null!==(n=e.simperium.lastRemoteUpdate.get(r))&&void 0!==n?n:-1/0,note:e.data.notes.get(r),searchQuery:e.ui.searchQuery}}),D)(P),x=n(342);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U(e);if(t){var o=U(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _(this,n)}}function _(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?A(e):t}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e){return function(e){if(Array.isArray(e))return K(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){H(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(l,e);var t,n,i,s=T(l);function l(){var e;R(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return H(A(e=s.call.apply(s,[this].concat(n))),"state",{heightCache:new a.c({defaultHeight:135,fixedWidth:!0,keyMapper:function(t){var n=e.props,r=n.filteredNotes,o=n.searchQuery,a=n.tagResultsFound;return 0===a&&0===r.length?"no-notes":0===o.length||0===a?r[t]:0===t?"tag-suggestions":1===t?"notes-header":r[t-2]}}),lastNoteDisplay:null}),H(A(e),"list",Object(r.createRef)()),H(A(e),"handleShortcut",(function(t){if(e.props.keyboardShortcuts){var n=t.ctrlKey,r=t.code,o=t.metaKey,a=t.shiftKey,i=e.props,c=i.isSmallScreen,s=i.showNoteList,l=n||o;return l&&a&&"KeyK"===r?(e.props.selectNoteAbove(),t.stopPropagation(),t.preventDefault(),!1):l&&a&&"KeyJ"===r?(e.props.selectNoteBelow(),t.stopPropagation(),t.preventDefault(),!1):c&&l&&a&&"KeyL"===r?(e.props.toggleNoteList(),t.stopPropagation(),t.preventDefault(),!1):!c||!s||"Enter"!==r||(e.props.openNote(),t.stopPropagation(),t.preventDefault(),!1)}})),H(A(e),"toggleShortcuts",(function(t){t?window.addEventListener("keydown",e.handleShortcut,!0):window.removeEventListener("keydown",e.handleShortcut,!0)})),e}return t=l,(n=[{key:"componentDidMount",value:function(){this.toggleShortcuts(!0)}},{key:"componentWillUnmount",value:function(){this.toggleShortcuts(!1)}},{key:"render",value:function(){var e=this,t=this.props,n=t.filteredNotes,i=t.hasLoaded,s=t.noteDisplay,l=t.onEmptyTrash,u=t.openedNote,p=t.searchQuery,f=t.showTrash,h=t.tagResultsFound,d=this.state.heightCache,y=function(e,t,n){return 0===t.length||0===n?e:["tag-suggestions","notes-header"].concat(M(e.length>0?e:["no-notes"]))}(n,p,h),m=y.findIndex((function(e){return e===u})),g=function(e,t){var n=t.heightCache;return function(t){var r=t.index,i=t.key,c=t.parent,s=t.style,l=e[r];return"no-notes"===l?o.a.createElement(a.b,{cache:n,columnIndex:0,key:"no-notes",parent:c,rowIndex:r},o.a.createElement("div",{className:"note-list is-empty",style:F(F({},s),{},{height:200})},o.a.createElement("span",{className:"note-list-placeholder"},"No Notes"))):"tag-suggestions"===l||"notes-header"===l?"tag-suggestions"===l?o.a.createElement(a.b,{cache:n,columnIndex:0,key:"tag-suggestions",parent:c,rowIndex:r},o.a.createElement(x.a,null)):o.a.createElement(a.b,{cache:n,columnIndex:0,key:"notes-header",parent:c,rowIndex:r},o.a.createElement("div",{className:"note-list-header"},"Notes")):o.a.createElement(a.b,{cache:n,columnIndex:0,key:i,parent:c,rowIndex:r},o.a.createElement(k,{invalidateHeight:function(){return n.clear(r,0)},noteId:l,style:s}))}}(y,{heightCache:d}),b=0===y.length,v=o.a.createElement("div",{className:"note-list-empty-trash theme-color-border"},o.a.createElement("button",{type:"button",className:"button button-borderless button-danger",onClick:l},"Empty Trash"));return o.a.createElement("div",{className:c()("note-list",{"is-empty":b})},b?o.a.createElement("span",{className:"note-list-placeholder"},i?"No Notes":"Loading Notes"):o.a.createElement(r.Fragment,null,o.a.createElement("div",{className:"note-list-items ".concat(s)},o.a.createElement(a.a,null,(function(t){var n=t.height,r=t.width;return o.a.createElement(a.d,{ref:e.list,estimatedRowSize:126,height:n,noteDisplay:s,notes:y,rowCount:y.length,rowHeight:d.rowHeight,rowRenderer:g,scrollToIndex:m,width:r})}))),f&&v))}}])&&I(t.prototype,n),i&&I(t,i),l}(r.Component);H(z,"displayName","NoteList"),H(z,"getDerivedStateFromProps",(function(e,t){return t.heightCache.clear(0),t.heightCache.clear(1),t.heightCache.clear(2),e.noteDisplay!==t.lastNoteDisplay?(t.heightCache.clearAll(),{lastNoteDisplay:e.noteDisplay}):null}));var B={onEmptyTrash:function(){throw new Error("Empty trash!")},openNote:g.a.ui.openNote,selectNoteAbove:g.a.ui.selectNoteAbove,selectNoteBelow:g.a.ui.selectNoteBelow,toggleNoteList:g.a.ui.toggleNoteList};t.default=Object(s.b)((function(e){return{hasLoaded:e.ui.hasLoadedNotes,isSmallScreen:b.b(e),keyboardShortcuts:e.settings.keyboardShortcuts,noteDisplay:e.settings.noteDisplay,filteredNotes:e.ui.filteredNotes,openedNote:e.ui.openedNote,openedTag:e.ui.openedTag,searchQuery:e.ui.searchQuery,showNoteList:e.ui.showNoteList,showTrash:e.ui.showTrash,tagResultsFound:e.ui.tagSuggestions.length}}),B)(z)}}]);